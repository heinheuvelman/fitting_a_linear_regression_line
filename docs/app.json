[{"name":"app.R","content":"library(shiny)\r\nlibrary(bslib)\r\n\r\nui <- page_sidebar(\r\n  title = \"Fitting a regression line\", \r\n  sidebar = sidebar(\r\n    sliderInput(\r\n      \"intercept\", \"Value of intercept:\", 1, 40000, 1\r\n    ),\r\n    sliderInput(\r\n      \"slope\", \"Value of slope coefficient\", 0, 4000, 1 \r\n    ),\r\n  ),\r\n  page_fluid(\r\n    plotOutput(\"lineplot\"),\r\n    plotOutput(\"hist_residuals\"),\r\n    card(\"Average distance of the points to the regression line (the smaller the better):\",\r\n    textOutput(\"averes\"),\r\n        \r\n  ))\r\n)\r\nplotOutput(\"lineplot\")\r\nserver <- function(input, output) {\r\n  output$lineplot <- renderPlot({\r\n    x <- seq(from = 0, to = 20, length.out = 1000)\r\n    y <- input$slope*x + input$intercept\r\n    set.seed(39432)\r\n    x_true <- rnorm(1000, 13, 4)\r\n    x_true <- sort(x_true)\r\n    y_true <- 13400 + 1500 * x_true + rnorm(1000, 0, 10000)\r\n    plot(x_true, y_true, xlab = \"Years of schooling\", ylab = \"Annual wage in GBPs\", ylim=c(0,80000))\r\n    abline(a = input$intercept, b = input$slope, lwd = 2, col = \"navy\")\r\n  })\r\n  output$hist_residuals <- renderPlot({\r\n    x <- seq(from = 0, to = 20, length.out = 1000)\r\n    y <- input$slope*x + input$intercept\r\n    set.seed(39432)\r\n    x_true <- rnorm(1000, 13, 4)\r\n    x_true <- sort(x_true)\r\n    y_true <- 13400 + 1500 * x_true + rnorm(1000, 0, 10000)\r\n    y_res <- y_true - y\r\n    hist(y_res, breaks = 30, xlim = c(-70000, 70000), main = \"Histogram of residuals (should centre on zero)\")\r\n    abline(v=0, col=\"red\", lwd=2)\r\n  })\r\n  output$averes <- renderText({\r\n    x <- seq(from = 0, to = 20, length.out = 1000)\r\n    y <- input$slope*x + input$intercept\r\n    set.seed(39432)\r\n    x_true <- rnorm(1000, 13, 4)\r\n    x_true <- sort(x_true)\r\n    y_true <- 13400 + 1500 * x_true + rnorm(1000, 0, 10000)\r\n    res_sq <- (y_true - y)^2\r\n    sum_res_sq <- sum(res_sq)\r\n    ave_res_sq <- sum_res_sq / 1000\r\n    ave_res <- sqrt(ave_res_sq)\r\n    round(ave_res, digits = 0)\r\n  })  \r\n}\r\nshinyApp(ui, server)","type":"text"}]
